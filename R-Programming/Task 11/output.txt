> # Simple Linear Regression
> path='Salary_Data.csv'
> dataset = read.csv(path)
> dataset
   YearsExperience Salary
1              1.1  39343
2              1.3  46205
3              1.5  37731
4              2.0  43525
5              2.2  39891
6              2.9  56642
7              3.0  60150
8              3.2  54445
9              3.2  64445
10             3.7  57189
11             3.9  63218
12             4.0  55794
13             4.0  56957
14             4.1  57081
15             4.5  61111
16             4.9  67938
17             5.1  66029
18             5.3  83088
19             5.9  81363
20             6.0  93940
21             6.8  91738
22             7.1  98273
23             7.9 101302
24             8.2 113812
25             8.7 109431
26             9.0 105582
27             9.5 116969
28             9.6 112635
29            10.3 122391
30            10.5 121872
> dim(dataset)
[1] 30  2
> dataset$Salary
 [1]  39343  46205  37731  43525  39891  56642  60150  54445  64445  57189  63218  55794  56957
[14]  57081  61111  67938  66029  83088  81363  93940  91738  98273 101302 113812 109431 105582
[27] 116969 112635 122391 121872
> dataset$YearsExperience
 [1]  1.1  1.3  1.5  2.0  2.2  2.9  3.0  3.2  3.2  3.7  3.9  4.0  4.0  4.1  4.5  4.9  5.1  5.3
[19]  5.9  6.0  6.8  7.1  7.9  8.2  8.7  9.0  9.5  9.6 10.3 10.5
> # Splitting the dataset into the
> # Training set and Test set
> install.packages('caTools')
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Installing package into ‘C:/Users/User1/AppData/Local/R/win-library/4.3’
(as ‘lib’ is unspecified)
trying URL 'https://cran.rstudio.com/bin/windows/contrib/4.3/caTools_1.18.2.zip'
Content type 'application/zip' length 245929 bytes (240 KB)
downloaded 240 KB

package ‘caTools’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
	C:\Users\User1\AppData\Local\Temp\Rtmpc7hcyb\downloaded_packages
> library(caTools)
Warning message:
package ‘caTools’ was built under R version 4.3.3 
> split = sample.split(dataset$Salary, SplitRatio = 0.7)
> trainingset = subset(dataset, split == TRUE)
> testset = subset(dataset, split == FALSE)
> 
> # Fitting Simple Linear Regression to the Training set
> lm.r= lm(formula = Salary ~ YearsExperience,
+          data = trainingset)
> summary(lm.r)

Call:
lm(formula = Salary ~ YearsExperience, data = trainingset)

Residuals:
    Min      1Q  Median      3Q     Max 
-7717.6 -5002.2    14.2  1410.5 11415.3 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)        24004       2996   8.013 1.64e-07 ***
YearsExperience     9754        471  20.709 1.69e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5900 on 19 degrees of freedom
Multiple R-squared:  0.9576,	Adjusted R-squared:  0.9553 
F-statistic: 428.9 on 1 and 19 DF,  p-value: 1.689e-14

> coef(lm.r)
    (Intercept) YearsExperience 
      24003.851        9753.475 
> #SSE,SSR
> sse=sum((fitted(lm.r)-trainingset$Salary)^2)
> sse
[1] 661468655
> ssr=sum((fitted(lm.r)-mean(trainingset$Salary))^2)
> ssr
[1] 14930833767
> sst <- ssr + sse
> sst
[1] 15592302423
> # Predicting the Test set results
> ypred = predict(lm.r, newdata = testset)
> ypred
        1         2         6        10        13        14        18        19        30 
 34732.67  36683.37  52288.93  60091.71  63017.75  63993.10  75697.27  81549.36 126415.34 
> summary(ypred)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  34733   52289   63018   66052   75697  126415 
> install.packages("ggplot2")
Error in install.packages : Updating loaded packages
> library(ggplot2)
Warning message:
package ‘ggplot2’ was built under R version 4.3.3 
> # Visualising the Training set results
> ggplot() + geom_point(aes(x = trainingset$YearsExperience,
+                           y = trainingset$Salary), colour = 'red') +
+   geom_line(aes(x = trainingset$YearsExperience,
+                 y = predict(lm.r, newdata = trainingset)), colour = 'blue') +
+   
+   ggtitle('Salary vs Experience (Training set)') +
+   xlab('Years of experience') +
+   ylab('Salary')
> ggplot() +geom_point(aes(x = testset$YearsExperience, y = testset$Salary),
+              colour = 'red') +
+   geom_line(aes(x = trainingset$YearsExperience,
+                 y = predict(lm.r, newdata = trainingset)),
+             colour = 'blue') +
+   ggtitle('Salary vs Experience (Test set)') +
+   xlab('Years of experience') +
+   ylab('Salary')
